---
title: 컴퓨터구조-멀티프로세서
tags: ['computer_science']
categories: [☁️ TIL]
thumbnail: ''
permalink: ''
status: ''
date: 2021-06-12 10:50:54
---

병렬처리 시스템, 멀티 프로세서의 상호연결 구조에는 어떤 것들이 있는지 알아본다.
`#parallel_system` `#multi_processor`
<!-- excerpt -->
<!-- toc -->

---

# Serial vs Parallel
- Serial Process system
    - CPU 가 하나뿐인 시스템
    - 기계적, 논리적 프로세싱으로 가장 효율적
- Parallel Process system
    - 동시에 여러작업 실행가능한 병렬처리 시스템
    - =병렬구조
    - 병렬처리 소프트웨어가(병렬 운영체제, 병렬 컴파일러, 메모리 공유) 과거에 비해 비약적인 발전을 이루고 있음


## Parallel Process system
- __다중장치 구조__
    - `다수의 CPU`로 동시에 여러개의 작업을 병렬로 처리
    - `공간적` 병렬성
- __파이프라인 구조__
    - `다수의 작업`을 각기 다른 실행단계에서 병렬로 처리
    - `시간적` 병렬성

## 멀티프로세서
- 메모리와 I/O 장치를 공유하는 `두 개 이상의 CPU`를 갖는 시스템
- 다중명령어 & 다중데이터 = `MIMD` 시스템에 포함된다.
- `하나의 운영체제`에 의해 프로세서-다른요소들 사이의 동작이 제어된다.
    - 동일한 문제해결을 위해 모든 요소들이 협력
- __시스템 신뢰성 향상__
    - `다수의 독립적 작업`들이 `병렬`적으로 처리된다.
    - `하나의 작업`이 여러 부분들로 나눠져 `병렬`로 처리된다.
- 사용자가 명시적으로 병렬실행 가능한 작업을 선언한다.
- 컴파일러가 자동적으로 프로그램의 `병렬성을 감지`하여 처리한다.

### 멀티프로세서 분류
- Shared memory ;공유메모리(=밀착결합 멀티프로세서): 연관성이 있는 작업을 할때
- Distributed memory: 프로세서마다 독립된 시스템
- Loosely coupled: 프로세서가 옮겨다니는 형식. 어느 경우에는 하나의 프로세서만 적용될 수 있음

---

## 멀티프로세서 상호연결 구조
- CPU, IOP(I/O Processor) 그리고 여러 모듈로 분리된 메모리 장치에 의해 구성된다.
- 공유 메모리 시스템: `프로세스와 메모리 사이`의 경로 수에 따름
- 느슨히 결합된 시스템: `프로세싱 요소들 사이`의 전송경로 수에 따라 물리적으로 다른 구성

### 1) 시분할 공통버스

- __단일__ 공통버스 시스템
    - 주어진 시간에 `하나의 프로세서만`이 시스템 버스를 사용
    - `충돌 발생시` 버스제어기에 의해 해결가능
    - 시스템 전체 전송률이 단일 경로의 속도에 `제한`된다
- __이중__ 버스 구조
    - 주어진 시간에 `하나의 프로세서만`이 시스템 버스를 사용
    - 시스템 버스 제어기에 각 `로컬버스`를 연결
    - 각 프로세서들의 대기시간 감소
    - 여러개의 버스 `동시전송` 가능
    - 시스템 구축 비용과 `복잡도`가 증가

### 2) 다중 포트 메모리
- CPU or IOP 와 각 메모리 모듈이 버스라인을 갖고 있는 시스템
- 각 모듈은 주어진 시간에 `어떤 포트가 메모리에 접근할 수 있을지` 결정하는 내부 `논리회로` 보유
- 메모리 접근을 위한 `우선순위는 포트의 위치`에 따라 결정
- `고가`의 메모리 제어 논리회로와 전선 커넥터

### 3) 크로스바 스위치 (Crossbar switch)
- _프로세스 버스_ 와 _메모리 모듈_ 통로간의 `교차점`에 위치한 여러개의 크로스포인트로 구성
- `크로스포인트`(crosspoints)
    - 프로세서와 메모리 모듈간의 `통로를 결정`하는 스위치
    - 버스에 실린 주소를 확인하여 통로를 열어주며, 주어진 `순위`에 따라 중재도 가능

### 4) 다단 교환망
- 2입력, 2출력 상호교환 스위치
- 2개 입력 중 하나만을 선택하여 전체 경로를 연결
- 충돌 중재
- 입출력 단자를 연결할 수 있는 제어신호 필요

### 5) 하이퍼 큐브 상호연결
- 2<super>n</super>개의 프로세서가 _n차원 이진 큐브_ 로 연결되어 느슨히 결합된 시스템
- 각 프로세서는 큐브의 `노드`를 형성. 이 노드에는 `CPU` 뿐 아니라 `로컬 메모리`나 `I/O 인터페이스`도 포함

---

## 중재 프로세스
- 공유 메모리 멀티프로세서 시스템에서 각 자원의 `효율적 분배`와 `상호 충돌을 배제`할 수 있는 `중재 프로세스`는 전체 시스템에 큰 영향을 준다.

### 중재 알고리즘
- 일반적으로 시스템 버스는 100여개의 신호라인으로 구성. 이 명령라인에 의해 논리가 성립.
    - 직렬 중재절차 (daisy-chain)
        - 순서가 정해져 있다. 우선순위가 높아도 작업이 끝날때까지 기다려야한다.
    - 병렬 중재논리
        - 순서가 정해져 있다.
    - 동적 중재논리
        - 큐를 설치

---

# 프로세서간 통신과 동기화
- 멀티 프로세서 시스템의 다양한 프로세서들은 `공통의 입출력 채널`을 통해 통신
- __공통 메모리의 역할__
    - 메모리의 일부를 모든 프로세서가 접근가능하도록 할당한 공간
    - `송신 프로세서`: 요구, 메시지, 프로시저 저장하여 의미있는 정보의 유무를 공지
    - `수신 프로세서`: 폴링방식에 의해 주기적 점검
        - 더 효율적인 통신방식? `인터럽트 신호`를 통하여 정보를 지정하여 통신

## 프로세서간 통신
- __주종모드__
    - 주프로세서: OS 기능수행
    - 종프로세서: 필요에 의한 인터럽트 요청
- __분리 운영체제__
    - 모든 프로세서가 자신의 운영체제 보유
    - 느슨한 결합 시스템에 적합
- __분산 운영체제__
    - 부동 운영체제: OS의 특정기능은 한 순간에 하나의 프로세서에만 작동
    - 운영체제가 여러 프로세서에 분산

## 프로세서간 동기화
- 멀티프로세서의 명령어 집합에는 동작하는 __프로세서와의 통신__ 과 __동기화__ 를 구현하는 명령어를 포함한다.
- 동기화의 필요성
    - 처리될 작업들간 순서를 유지할 수 있다.
    - 공통 변수에 대한 상호배제적 접근을 보장한다.
- 동기화를 위해 가장 많이 활요되는 기법에 `이진 세마포`가 있다.

# 캐시의 일관성
- __cache coherence__
    - 공유 메모리 멀티프로세서 시스템에서도 각 프로세서는 로컬 메모리를 운영한다.
    - 정확한 메모리 동작을 위해 이 내용들이 모두 동일하게 유지되어야 한다.
- 메모리에 쓰기동작시 메모리 갱신
    - write-through: 쓰기동작 발생시 `cache 와 주기억장치 모두 갱신`
    - write-back: `cache만 갱신`하고 메모리로 전달가능한 위치 표시

## 캐시 일관성에 대한 헤결책
- 각 프로세서에 개별적 cache를 허용하지 않고 주기억장치에 `공용 cache 메모리를 둔다.`
    - 평균접근시간을 증가시킨다.
- __캐시가능(cachable)__
    - 비 공유적, `읽기 전용 데이터`에 한해 cache 데이터에 저장하도록 한다.
- __스누피 캐시 제어기__
    - 기본적으로 버스에 부착된 cache에 대해 `버스-감시 기능을 유지` 하도록 설계된 하드웨어 장치이다.