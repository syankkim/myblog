---
title: 🖨 컴퓨터구조-파이프라인
tags: ['computer_science']
categories: [☁️ TIL]
thumbnail: ''
permalink: ''
status: ''
date: 2021-06-05 10:50:54
---

파이프라인
<!-- excerpt -->
<!-- toc -->

---


# 병렬처리

> 컴퓨터 시스템의 계산 속도의 향상을 목적으로 동시 데이터 처리기능을 제공하는 광범위한 개념의 기술.
>- 다중 기능장치를 가진 레지스터
> - 실행 장치를 동시에 동작되는 8개의 기능장치로 나눔


## 병렬처리 구조 분류방법 M.J

- SISD : 단일 명령어, 단일 데이터
- SIMD : 단일 명령어, 다중 데이터
- MISD : 다중 명령어, 단일 데이터
- MIMD : - 다중 명령어, 다중 데이터
  - 여러 프로그램 동시수행 능력
  - 대부분의 다중 프로세서와 다중 컴퓨터 시스템



# 파이프 라인

## 파이프라인 구조 성능
- 파이프 라인의 동작은 공간, 시간표에 의해 설명되는데, 이것은 시간에 대한 함수로서 세그먼트의 사용현황을 나타낸다.
- 동일한 복잡도의 부연산들로 이루어지는 연산동작도 구현가능하다.
- 매번 다른 집합을 동일한 태스크에 적용해, 반복적인 일에 효과적이다.
- __그러나,__ 각 레지스터 Ri 에 분리되는 작업들의 업무강도가 비슷해야 한다. 업무강도가 가장 높은 작업에 비중을 둘 수 밖에 없어서 `유휴시간`이 생긴다.

> 파이프라인의 `이론적 최대속도 증가율`은 `세그먼트 수와 같다.`
> - 즉 세그먼트가 많을 수록 효과적이다.



## 클럭 사이클시간

<img width="630" alt="파이프라인1" src="https://user-images.githubusercontent.com/28856435/121041772-0251ef00-c7ee-11eb-90d2-5493c5ee541b.PNG">

<br>

>위와 같은 파이프라인의 클럭 사이클시간을 구하는 공식은 아래와 같다.
> k + (n-1) 
(= k개의 세그먼트 파이프라인에서 n개의 데스크를 수행)
즉 위의 식에 대입하면 4 + (6-1)= 9
`:: 9개의 클럭사이클을 수행한다.`

## 파이프라인 구현
- 하나의 프로세스를 서로 다른 기능을 가진 서브프로세스로 나누어 각 프로세스가 `동시에` 서로 다른 데이터를 취급하도록 하는 기법
- 각 세그먼트에서 수행된 연산결과는 다음 세그먼트로 연속적으로 넘어간다.
    - 마지막 세그먼트를 통과하게되면 최종 연산결과를 얻는다.
     - 하나의 프로세스를 다양한 연산으로 중복시킬 수 있는 근간은 `세그먼트`마다의 `레지스터`이다.

- 곱셈과 덧셈이 섞인 다항식 연산
__Ai X Bi + Ci (i= 1,2,3 ...7)__
- R1 ~ R5 레지스터와 조합논리회로 (Adder, Multiplier) 구성

<img width="693" alt="파이프라인2" src="https://user-images.githubusercontent.com/28856435/121041793-08e06680-c7ee-11eb-9c19-daec02459cc3.PNG">

<br>

* 수도코드
|수도코드|설명|
|-----------------|-----------------|
|R1 <- Ai, R2 <- Bi|Ai와 Bi의 입력|
|R1 <- R1 X R2, R4 <- Ci|곱셈과 Ci의 입력|
|R1 <- R3 + R4|곱셈 결과와 Ci의 덧셈|

<br>

* 세번의 clock pulse이후부터 R5의 첫번째 결과획득 및 파이프 라인상에서 데이터 이동시작

<img width="533" alt="파이프라인3" src="https://user-images.githubusercontent.com/28856435/121041815-0ed64780-c7ee-11eb-839a-b6b983423a89.PNG">


|Clock Pulse|Segment1||Segment2||Segment3|
|----------|--------|-------|-----|
|-|R1| R2|R3| R4|R5|
|1|A<sub>1</sub>|<sub>1</sub>||
|2|<sub>1</sub>|<sub>1</sub>|<sub>1</sub>|
|3|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|4|<sub>1</sub>|||
|5||||
|6||||
|7||||
|8||||
|9||||

## 파이프라인 데이터 처리

> * 예시
>   - 각 세그먼트에서 부연산 수행 소요시간: t<sub>p</sub>= `20ns`
>   - 파이프 라인은 `k=4` 세그먼트
>   - 태스크의 수: `n=100`

__-> 파이프라인 구조를 활용한 경우 총 소요시간__
`(k+ n-1)t<sub>p</sub>` = (4+100-1) X 20 = 2060ns

__-> 비 파이프라인 시스템__
각 태스크 완료시간: t<sub>n</sub>= kt<sub>p</sub> = 4 X 20 = 80ns
전체 태스크 완료시간: nkt<sub>p</sub> = 100 X 80 = 8000ns

__:: 속도 증가율을 확인할 수 있다.__
8000/2060 = 3.88 ~= 4

---

# 현실적 파이프라인

## 파이프라인 VS 병렬 다중기능 장치
- 실제 파이프라인 구조가 이론적인 최대속도 구현 불가
    - 각 세그먼트들이 부연산을 수행하는 시간이 다르다.
    - 최대 전파시간을 갖는 세그먼트의 지연시간에 맞춰야한다.
- 그래서, 병렬적인 다중기능장치를 고려 할 수 있다.
    - 순차적 처리가 아닌, 데이터를 동시에 입력 받아 태스크를 동시에 처리한다. (SIMD구조)

## 파이프라인 구조 적용

### 산술 파이프라인
- 산술 연산들을 부연산으로 나누어 파이프라인의 세그먼트에서수행
    - eg. 부동 소수점 연산, 과학계산 등

- 부동 소수점 덧셈/뺄셈을 위한 파이프라인
@@@


### 명령어 파이프라인
- 명령어 사이클의 fetch, 디코드, 실행단계를 중첩기켜 명령어 흐름에 동작